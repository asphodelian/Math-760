---
title: "Math 760"
author: "Gabrielle Salamanca"
date: "Jan 29, 2024"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Chapter 2

```{r}
library(expm)
library(Matrix)
library(matrixcalc)
```

## 4. When $A^{-1}$ and $B^{-1}$ exist, prove each of the following.

*Hint*: Part (a) can be proved by noting that $AA^{-1} = I)$, I = I', and $(AA^{-1}) = (A^{-1})'A'$. Part (b) follows from $(B^{-1}A^{-1})AB = B^{-1}(A^{-1}A)B = B^{-1}B = I$

### (a) $(A')^{-1} = (A^{-1})'$

We know:

I = I'
$AA^{-1} = I = A^{-1}A$

Therefore, $I' = I = (AA^{-1})' = (A^{-1})'A'$ and $I = (A^{-1}A)' = A'(A^{-1})'$. And because of this, this means $(A')^{-1}$ is the inverse of A', $(A')^{-1} = (A^{-1})'$

### (b) $(AB)^{-1} = B^{-1}A^{-1}$

We know:

If $\exists$ a matrix B s.t. BA = AB = I, then B is called the inverse of A and is denoted by $A^{-1}$. And, $(B^{-1}A^{-1})AB = B^{-1}(A^{-1}A)B = B^{-1}B(I) = I(I) = I$

So following all that, AB has inverse $(AB)^{-1} = B^{-1}A^{-1}$

## 5. Check that

$Q = \begin{bmatrix} \frac{5}{13} & \frac{12}{13}\\ -\frac{12}{13} & \frac{5}{13} \end{bmatrix}$

is an orthogonal matrix.

We want to know if $Q*Q^T = I$, to prove that Q is an orthogonal matrix. The $Q^T$ is:

```{r}
Qmat <- c(5/13,12/13,-12/13,5/13)
Q <- matrix(Qmat, nrow = 2, ncol = 2, byrow = TRUE)
QT <- t(Q)
print(QT)
```

Now, we'll multiply the two matrices and see if the answer is an identity matrix.

```{r}
Q%*%QT
```

Thus, Q is an orthogonal matrix.

## 6. Let

$A = \begin{bmatrix} 9 & -2\\ -2 & 6 \end{bmatrix}$

```{r}
aMat <- c(9,-2,
          -2,6)
A <- matrix(aMat, nrow = 2, ncol = 2, byrow = TRUE)
```

### (a) Is **A** symmetric?

```{r}
isSymmetric(A)
AT <- t(A)
cat(A," = ", AT)
```

Yes, **A** is symmetric. 

### (b) Show that **A** is a positive definite

```{r}
is.positive.definite(A)
ev <- eigen(A)
value <- ev$values
cat("The eigenvalues of A are:", value, ".")
```

Because the eigenvalues are positive, A is a positive definite

## 14. Show that $Q'_{(p \ x \ p)}, A_{(p \ x \ p)}, Q_{(p \ x \ p)}$, and $A_{(p \ x \ p)}$ have the same eigenvalues if Q is orthogonal. 

Hint: Let $\lambda$ be an eigenvalue of **A**. Then $0 = |A - \lambda I|$. By Exercise 2.13 and Result 2A.11(e), we can write $0 = |Q'||A - \lambda I||Q| = |Q'AQ - \lambda I|$, since Q'Q = I. 

With the hint in mind, we can write: $0 = |Q||A - \lambda I||Q'| = |QAQ' - \lambda I|$. If Q is orthogonal, then $\lambda$ is also an eigenvalue of QAQ'.

## 20. Determine the square-root matrix $A^{1/2}$, using the matrix A in Exercise 2.3. Also, determine $A^{-1/2}$, and show that $A^{1/2}A^{-1/2} = A^{-1/2}A^{1/2} =I$.

$A^{1/2}$ is

```{r}
aMat <- c(2,1,1,3)
A <- matrix(aMat, nrow = 2, ncol = 2, byrow = TRUE)
sqrtMat <- sqrtm(A)
sqrtMat
```

$A^{-1/2}$ is

```{r}
neg <- solve(sqrtMat)
neg
```

Now, we prove $A^{1/2}A^{-1/2} = A^{-1/2}A^{1/2} = I$.

```{r}
AAneg <- sqrtMat%*%neg
negAA <- neg%*%sqrtMat
AAneg
negAA
```

## 26. Use $\Sigma$ as given in Exercise 2.25

$\Sigma =$

```{r}
sigMat <- c(25, -2, 4,
            -2, 4, 1,
            4, 1, 9)
sigma <- matrix(sigMat, nrow = 3, ncol = 3, byrow = TRUE)
sigma
```

### (a) Find $\rho_{13}$.

$\rho_{13} = \frac{\sigma_{13}}{\sqrt{\sigma_{11}} \sqrt{\sigma_{22}}}$ =

```{r}

```


### (b) Find the correlation between $X_1$ and $\frac{1}{2}X_2 + \frac{1}{2}X_3$.

## 32. You are given the random vector $X' = \begin{bmatrix} X_1, X_2, ..., X_5 \end{bmatrix}$ with mean vector $\mu_X' = \begin{bmatrix} 2, 4, -1, 3 \end{bmatrix}$, and variance-covariance matrix

$\Sigma_X = \begin{bmatrix} 4 & -1 & \frac{1}{2} & -\frac{1}{2} & 0\\ -1 & 3 & 1 & -1 & 0\\ \frac{1}{2} & 1 & 6 & 1 & -1\\ -\frac{1}{2} & -1 & 1 & 4 & 0\\ 0 & 0 & -1 & 0 & 2 \end{bmatrix}$

Partition **X** as

$X = \begin{bmatrix} X_1\\ X_2\\ ---\\ X_3\\ X_4\\ X_5 \end{bmatrix} = \begin{bmatrix} X^{(1)}\\ ---\\ X^{(2)}\end{bmatrix}$

Let

$A = \begin{bmatrix} 1 & -1\\ 1 & 1 \end{bmatrix}$ and $B = \begin{bmatrix} 1 & 1 & 1\\ 1 & 1 & -2 \end{bmatrix}$

and consider the linear combinations $AX^{(1)}$ and $BX^{(2)}$. Find

### (a) $E(X^{(1)})$

### (b) $E(AX^{(1)})$

### (c) $Cov(X^{(1)})$

### (d) $Cov(AX^{(1)})$

### (e) $E(X^{(2)})$

### (f) $E(BX^{(2)})$

### (g) $Cov(X^{(2)})$

### (h) $Cov(BX^{(2)})$

### (i) $Cov(X^{(1)}, X^{(2)})$

### (j) $Cov(AX^{(1)}, BX^{(2)})$

## 34. Consider the vectors $b' = \begin{bmatrix} -4 ,3 \end{bmatrix}$ and $d' = \begin{bmatrix} -1, 3, -2, 1 \end{bmatrix}$. Verify the Cauchy-Schwarz inequality $(b,d)^2 \leq (b'b)(d'd)$.

## 42. Repeat Exercise 2.41, but with

$\Sigma_X = \begin{bmatrix} 3 & 1 & 1 & 1\\ 1 & 3 & 1 & 1\\ 1 & 1 & 3 & 1\\ 1 & 1 & 1 & 3 \end{bmatrix}$

Let

$A = \begin{bmatrix} 1 & -1 & 0 & 0\\ 1 & 1 & -2 & 0\\ 1 & 1 & 1 & -3 \end{bmatrix}$

```{r}
sigMat <- c(3,1,1,1,
            1,3,1,1,
            1,1,3,1,
            1,1,1,3)
aMat <- c(1,-1,0,0,
          1,1,-2,0,
          1,1,1,-3)
sigma <- matrix(sigMat, nrow = 4, ncol = 4, byrow = TRUE)
A <- matrix(aMat, nrow = 3, ncol = 4, byrow = TRUE)
```


### (a) Find E(**AX**), the mean of **AX**.

### (b) Find Cov(**AX**), the cariances and covariances of **AX**. 

### (c) Which pairs of linear combinations have zero covariances?
